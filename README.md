# GPT-seizure-freedom

## Summary
This is the repository containing code required to replicate the analyses and figures for the manuscript "Zero-Shot Extraction of Seizure Outcomes from Clinical Notes Using Generative Pretrained Transformers" published in the Journal of Healthcare Informatics Research. If you use any material from this repository, please cite our [paper](https://link.springer.com/article/10.1007/s41666-025-00198-5)!

Ojemann, W.K.S., Xie, K., Liu, K. et al. Zero-Shot Extraction of Seizure Outcomes from Clinical Notes Using Generative Pretrained Transformers. J Healthc Inform Res (2025). https://doi.org/10.1007/s41666-025-00198-5

## Contents
* infer_llama.py
  * Script for running inference on medical notes using the Llama2-13b-instruct checkpoint. This script contains code to generate predictions for all prompt engineering methods described in the methods section. This script was used to generate seizure freedom predictions for both the validation dataset and the disparities analysis.
* seq_class.py
  * Script for training a BERT model to classify reasoning output from Llama2 into seizure freedom classes.
* eval_llama.py
  * Script for extracting seizure freedom classes from Llama2 output. This script employs regex rules for the one-word prompt and deploys the pretrained BERT model (seq_class.py) to extract seizure freedom classes from reasoning outputs.
* GPT_analysis_and_visualization.ipynb
  * Notebook for performing statistical comaprisons between different prompt engineering strategies and datasets. This notebook contains the code used to generate Figures 1, 2, 3, and 4 as well as values for Table 2. The notebook also contains code used to generate summary statistics for results sections 3.1-3.4 and 3.6 of the manuscript.
* logistic_mixed_effects.py
  * Script for analyzing rates of seizure freedom by different demographic variables as described in our previous [work](https://academic.oup.com/jamia/article-abstract/31/6/1348/7628160?redirectedFrom=fulltext&login=false). This script contains the code used to generate the summary statistics in results section 3.5.
  * The script was run independently run with the seizure freedom predictions generated by the Llama2 and BERT models. For the code used to generate seizure freedom predictions on this dataset see the repository from our previous [publication](https://github.com/penn-cnt/NLP_Disparities_in_Seizure_Freedom/tree/main).
* forest_plot.py
  * Script for generating forest plots for disparities analysis. This script contains the code used to generate Figure 5 in the manuscript as well as the corrected p-values in results section 3.5 of the manuscript.
  * To generate the final forest plot, the forest_plot.py script was independently run with BERT and Llama2 outputs from logistic_mixed_effects.py and overlayed.
